{"ast":null,"code":"var _jsxFileName = \"/Users/waltorhuang/cookbook/javascript/aries-financial-web/src/components/stake/stake.jsx\";\nimport i18next from \"i18next\";\nimport React, { Component } from \"react\";\nimport \"./stake.sass\";\nimport { CONNECTION_CONNECTED, CONNECTION_DISCONNECTED } from '../../constants';\nimport Loader from '../loader';\nimport Store from \"../../stores\";\nimport { GET_STAKE_APY_DETAIL, GET_STAKE_APY_DETAIL_DONE } from \"../../constants/constants-extension\";\nimport APYFrame from \"../../widgets/APYFrame\";\nimport StakeDetail from \"../stake-detail\";\nconst emitter = Store.emitter;\nconst dispatcher = Store.dispatcher;\nconst store = Store.store;\n\nclass Stake extends Component {\n  constructor(props) {\n    super(props);\n\n    this.connectionConnected = () => {\n      const account = store.getStore('account');\n      const that = this;\n      this.setState({\n        loading: true,\n        account: account,\n        address: account.address ? account.address.substring(0, 6) + '...' + account.address.substring(account.address.length - 4, account.address.length) : null\n      });\n      setTimeout(() => {\n        const snackbarObj = {\n          snackbarMessage: i18next.t(\"Unlock.WalletConnected\"),\n          snackbarType: 'Info'\n        };\n        that.setState(snackbarObj);\n      });\n    };\n\n    this.connectionDisconnected = () => {\n      this.setState({\n        account: null,\n        address: null\n      });\n    };\n\n    this.getAPYDetail = () => {\n      this.setState({\n        loading: false\n      });\n    };\n\n    this.onStake = pool => {\n      this.setState({\n        isStakeDetail: !this.state.isStakeDetail,\n        pool\n      });\n    };\n\n    this.loopAPYFrame = stakePools => {\n      return stakePools.map((pool, i) => {\n        const token = pool.tokens[0]; // console.log(token, token.ariesAPY, token.decimals, \"tokens ==\");\n\n        return /*#__PURE__*/React.createElement(APYFrame, Object.assign({\n          key: `APYFrame-${i}`\n        }, pool, {\n          onStake: () => this.onStake(pool),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 11\n          }\n        }));\n      });\n    };\n\n    const _account = store.getStore('account');\n\n    this.state = {\n      account: _account,\n      address: _account.address ? _account.address.substring(0, 6) + '...' + _account.address.substring(_account.address.length - 4, _account.address.length) : null,\n      loading: true,\n      isStakeDetail: false,\n      pool: null\n    };\n    dispatcher.dispatch({\n      type: GET_STAKE_APY_DETAIL,\n      content: {}\n    });\n  }\n\n  componentWillMount() {\n    emitter.on(CONNECTION_CONNECTED, this.connectionConnected);\n    emitter.on(CONNECTION_DISCONNECTED, this.connectionDisconnected);\n    emitter.on(GET_STAKE_APY_DETAIL_DONE, this.getAPYDetail);\n  }\n\n  componentWillUnmount() {\n    emitter.removeListener(CONNECTION_CONNECTED, this.connectionConnected);\n    emitter.removeListener(CONNECTION_DISCONNECTED, this.connectionDisconnected);\n    emitter.removeListener(GET_STAKE_APY_DETAIL_DONE, this.getAPYDetail);\n  }\n\n  render() {\n    const {\n      loading,\n      isStakeDetail,\n      pool\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: `stake`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 4\n      }\n    }, loading && /*#__PURE__*/React.createElement(Loader, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 18\n      }\n    }), !isStakeDetail ? /*#__PURE__*/React.createElement(\"div\", {\n      className: `section`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 6\n      }\n    }, this.loopAPYFrame(store.store.stakePools)) : /*#__PURE__*/React.createElement(StakeDetail, {\n      pool: pool,\n      goBack: () => this.onStake(pool),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 6\n      }\n    }));\n  }\n\n}\n\nexport default Stake;","map":{"version":3,"sources":["/Users/waltorhuang/cookbook/javascript/aries-financial-web/src/components/stake/stake.jsx"],"names":["i18next","React","Component","CONNECTION_CONNECTED","CONNECTION_DISCONNECTED","Loader","Store","GET_STAKE_APY_DETAIL","GET_STAKE_APY_DETAIL_DONE","APYFrame","StakeDetail","emitter","dispatcher","store","Stake","constructor","props","connectionConnected","account","getStore","that","setState","loading","address","substring","length","setTimeout","snackbarObj","snackbarMessage","t","snackbarType","connectionDisconnected","getAPYDetail","onStake","pool","isStakeDetail","state","loopAPYFrame","stakePools","map","i","token","tokens","dispatch","type","content","componentWillMount","on","componentWillUnmount","removeListener","render"],"mappings":"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","sourcesContent":["import i18next from \"i18next\";\nimport React, { Component } from \"react\";\nimport \"./stake.sass\"\n\nimport {\n\tCONNECTION_CONNECTED,\n\tCONNECTION_DISCONNECTED,\n} from '../../constants';\n\nimport Loader from '../loader';\n\nimport Store from \"../../stores\";\nimport {GET_STAKE_APY_DETAIL, GET_STAKE_APY_DETAIL_DONE} from \"../../constants/constants-extension\";\nimport APYFrame from \"../../widgets/APYFrame\";\nimport StakeDetail from \"../stake-detail\";\nconst emitter = Store.emitter;\nconst dispatcher = Store.dispatcher;\nconst store = Store.store;\n\nclass Stake extends Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tconst account = store.getStore('account');\n\n\t\tthis.state = {\n\t\t\taccount: account,\n\t\t\taddress: account.address ? account.address.substring(0,6)+'...'+account.address.substring(account.address.length-4,account.address.length) : null,\n\t\t\tloading: true,\n\t\t\tisStakeDetail: false,\n\t\t\tpool: null,\n\t\t};\n\t\tdispatcher.dispatch({ type: GET_STAKE_APY_DETAIL, content: {} });\n\t}\n\n\tcomponentWillMount() {\n\t\temitter.on(CONNECTION_CONNECTED, this.connectionConnected);\n\t\temitter.on(CONNECTION_DISCONNECTED, this.connectionDisconnected);\n\t\temitter.on(GET_STAKE_APY_DETAIL_DONE, this.getAPYDetail);\n\t}\n\n\tcomponentWillUnmount() {\n\t\temitter.removeListener(CONNECTION_CONNECTED, this.connectionConnected);\n\t\temitter.removeListener(CONNECTION_DISCONNECTED, this.connectionDisconnected);\n\t\temitter.removeListener(GET_STAKE_APY_DETAIL_DONE, this.getAPYDetail);\n\t};\n\n\tconnectionConnected = () => {\n\t\tconst account = store.getStore('account');\n\t\tconst that = this;\n\n\t\tthis.setState({\n\t\t\tloading: true,\n\t\t\taccount: account,\n\t\t\taddress: account.address ? account.address.substring(0,6)+'...'+account.address.substring(account.address.length-4,account.address.length) : null\n\t\t});\n\n\t\tsetTimeout(() => {\n\t\t\tconst snackbarObj = { snackbarMessage: i18next.t(\"Unlock.WalletConnected\"), snackbarType: 'Info' }\n\t\t\tthat.setState(snackbarObj)\n\t\t})\n\t};\n\n\tconnectionDisconnected = () => {\n\t\tthis.setState({\n\t\t\taccount: null,\n\t\t\taddress: null\n\t\t})\n\t};\n\n\tgetAPYDetail = () => {\n\t\tthis.setState({\n\t\t\tloading: false,\n\t\t})\n\t};\n\n\tonStake = (pool) => {\n\t\tthis.setState({isStakeDetail: !this.state.isStakeDetail, pool})\n\t};\n\n\tloopAPYFrame = (stakePools) => {\n\t\treturn stakePools.map((pool, i) => {\n\t\t\tconst token = pool.tokens[0];\n\t\t\t// console.log(token, token.ariesAPY, token.decimals, \"tokens ==\");\n\t\t\treturn <APYFrame key={`APYFrame-${i}`} {...pool} onStake={() => this.onStake(pool)} />;\n\t\t})\n\t};\n\n\trender() {\n\t\tconst { loading, isStakeDetail, pool } = this.state;\n\n\t\treturn (\n\t\t\t<div className={`stake`}>\n\t\t\t\t{ loading && <Loader /> }\n\t\t\t\t{ !isStakeDetail ?\n\t\t\t\t\t<div className={`section`}>{this.loopAPYFrame(store.store.stakePools)}</div> :\n\t\t\t\t\t<StakeDetail pool={pool} goBack={() => this.onStake(pool)}/>\n\t\t\t\t}\n\t\t\t</div>\n\t\t);\n\t};\n}\n\nexport default Stake;\n"]},"metadata":{},"sourceType":"module"}